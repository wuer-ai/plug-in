# 开发经验总结

## 项目背景
本项目开发了一个名为"相守晴雨表"的微信小程序，主要功能是评估和改善伴侣关系健康状况。之前也有开发Chrome扩展的经验，本文将两者共通的开发经验进行总结。

## 关键经验

### 1. 配置文件与路径问题

- **问题**：配置文件路径设置不正确导致应用无法正常加载资源
- **解决方案**：
  - 小程序和Chrome扩展中的路径都是相对于根目录的相对路径
  - 确保使用正确的路径格式，避免使用错误的相对路径表示
  - 文件夹名称和文件名区分大小写，特别在Windows环境下易被忽略

### 2. 文件结构组织

- **最佳实践**:
  - 将配置信息集中在专门的配置文件中（如微信小程序的`config.js`）
  - 将资源文件（如图标）放在专门的文件夹中
  - 确保配置文件与实际文件结构一致
  - 为适应不同场景，准备多种尺寸的图标资源

### 3. 组件开发与调试技巧

- **微信小程序**:
  - 使用`app.json`中的`"debug": true`开启调试模式
  - 在微信开发者工具中查看Console日志和网络请求
  - 针对复杂组件（如雷达图），提供备用实现方案
  - 在关键位置添加错误处理，避免组件错误导致整个页面崩溃

- **Chrome扩展**:
  - 当扩展加载失败时，检查Chrome扩展页面中的错误信息
  - 常见错误包括图标文件不存在、manifest.json格式错误、权限不足等
  - 临时解决方案可以尝试简化配置，例如使用单一图标而非多个尺寸

### 4. 功能实现要点

- **微信小程序**:
  - 创建集中式配置文件管理应用的关键信息（如`utils/config.js`）
  - 使用组件化开发方式，将复杂功能封装为独立组件
  - 小程序的页面生命周期函数(`onLoad`、`onShow`等)使用时机需谨慎选择

- **Chrome扩展**:
  - 在manifest.json中正确声明权限和配置
  - 使用service_worker处理事件
  - iframe加载外部网站时需考虑跨域问题

### 5. 中文编码与国际化处理

- 在HTML和WXML文件中使用正确的编码确保中文显示正确
- 配置文件中的中文内容需确保以UTF-8编码保存
- Windows环境下需特别注意文件编码格式
- 把所有用户可见的文本集中管理，便于后期国际化

## 调试流程建议

1. **系统化排除法**:
   - 先确保基本功能正常，再添加复杂功能
   - 出现问题时，采用二分法定位：逐步排除可能的原因
   - 对于复杂组件，尝试使用最简单配置先运行起来，然后逐步添加功能

2. **善用开发者工具**:
   - 微信开发者工具和Chrome开发者工具提供的控制台是首要调试工具
   - 使用断点调试复杂的JavaScript逻辑
   - 微信小程序可使用真机调试解决部分模拟器无法发现的问题

3. **检查清单**:
   - 文件路径是否正确
   - 文件名大小写是否一致
   - 权限和配置是否完整
   - 文件编码是否正确（特别是包含中文的文件）
   - 组件的生命周期函数是否正确使用
   - 数据格式是否符合预期

4. **文档化错误处理**:
   - 记录常见错误和解决方案（如项目中的`TROUBLESHOOTING.md`）
   - 为每个复杂组件创建使用说明文档
   - 将调试经验系统化，便于团队共享和学习

## 总结

无论是微信小程序还是Chrome扩展开发，细节决定成败。路径配置、文件组织、编码格式和组件调试是最容易出问题的环节。建立良好的项目结构，正确理解相对路径概念，系统化管理配置信息，以及建立完善的错误处理机制，是成功开发的关键。

在微信小程序项目中，特别要注意组件生命周期、数据传递方式以及渲染性能优化。对于复杂的视觉组件（如雷达图），需要更加细致的测试和验证，确保在各种场景下都能正常工作。 